## Vim 中使用宏实现批量修改

来源：[https://xiaozhuanlan.com/topic/0124375869](https://xiaozhuanlan.com/topic/0124375869)

时间 2018-03-11 18:41:35


  
一直觉得 Vim 中的宏过于高深，也没什么机会用，偶然发现一个小痛点可以借助宏来快速解决。

所谓的宏，其实就是记录一系列命令，然后选择重放次数。举个例子，假设我用 Vim 在写 Markdown：

 
``` 
1. 第一句
2. 第二句
3. 第三句
4. 第四句
5. 第五句
6. 第六句
7. 第七句
8. 第八句
```

一切都没有问题，直到有一天我发现在第一句和第二句之间还可以插入一句：

```shell

  

* 第一句
* 这里新插入了一句
* 第二句
* 第三句
* 第四句
* 第五句
* 第六句
* 第七句
    
```
  

  
一直觉得 Vim 中的宏过于高深，也没什么机会用，偶然发现一个小痛点可以借助宏来快速解决。

所谓的宏，其实就是记录一系列命令，然后选择重放次数。举个例子，假设我用 Vim 在写 Markdown：

 
``` 
1. 第一句
2. 第二句
3. 第三句
4. 第四句
5. 第五句
6. 第六句
7. 第七句
8. 第八句
```

一切都没有问题，直到有一天我发现在第一句和第二句之间还可以插入一句：

 
``` 
1. 第一句
2. 这里新插入了一句
2. 第二句
3. 第三句
4. 第四句
5. 第五句
6. 第六句
7. 第七句
8. 第八句
```

虽然 Markdown 左侧列表的数字并不影响最终的展现形式，但强迫症总感觉不爽，想把序号改过来。挨个去改总归是麻烦，此时就可以用宏来操作，用伪代码表示就是：

 
``` 
起手式：光标停在第二行第一列
开始录制宏
向下一行
把数字加一
结束录制宏
再执行六次宏（分别把数字 3-8 改成 4-9）
```

在 Vim 中的操作则是：

 
``` 
qa       （q 表示开始录制宏，a 表示录制内容存储在寄存器  a 中）
j        （向下一行）
ctrl + a （数字加一）
q        （结束录制宏）
6@a      （把存储在寄存器 a 中的宏执行 6 次）
```

熟练了以后，按键就是`qaj<C-a>q6@a`。    

  

  
一直觉得 Vim 中的宏过于高深，也没什么机会用，偶然发现一个小痛点可以借助宏来快速解决。

所谓的宏，其实就是记录一系列命令，然后选择重放次数。举个例子，假设我用 Vim 在写 Markdown：

 
``` 
1. 第一句
2. 第二句
3. 第三句
4. 第四句
5. 第五句
6. 第六句
7. 第七句
8. 第八句
```

一切都没有问题，直到有一天我发现在第一句和第二句之间还可以插入一句：

 
``` 
1. 第一句
2. 这里新插入了一句
2. 第二句
3. 第三句
4. 第四句
5. 第五句
6. 第六句
7. 第七句
8. 第八句
```

虽然 Markdown 左侧列表的数字并不影响最终的展现形式，但强迫症总感觉不爽，想把序号改过来。挨个去改总归是麻烦，此时就可以用宏来操作，用伪代码表示就是：

 
``` 
起手式：光标停在第二行第一列
开始录制宏
向下一行
把数字加一
结束录制宏
再执行六次宏（分别把数字 3-8 改成 4-9）
```

在 Vim 中的操作则是：

 
``` 
qa       （q 表示开始录制宏，a 表示录制内容存储在寄存器  a 中）
j        （向下一行）
ctrl + a （数字加一）
q        （结束录制宏）
6@a      （把存储在寄存器 a 中的宏执行 6 次）
```

熟练了以后，按键就是`qaj<C-a>q6@a`。    

  


